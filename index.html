<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aplikasi Playlist Lagu</title>
    <!-- Memuat Tailwind CSS untuk styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Memuat Font Awesome untuk ikon -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        /* Style kustom untuk tampilan yang lebih baik */
        body {
            font-family: 'Inter', sans-serif;
        }
        .playlist-item:hover .delete-btn {
            opacity: 1;
        }
        .delete-btn {
            opacity: 0;
            transition: opacity 0.2s ease-in-out;
        }
    </style>
</head>
<body class="bg-gray-900 text-white flex items-center justify-center min-h-screen p-4">

    <div class="bg-gray-800 rounded-2xl shadow-2xl p-6 w-full max-w-lg">
        
        <!-- Header Aplikasi -->
        <div class="text-center mb-6">
            <h1 class="text-3xl font-bold text-cyan-400">Playlist Laguku</h1>
            <p class="text-gray-400 mt-1">Dibuat dengan Konsep Linked List</p>
        </div>

        <!-- Form Tambah Lagu -->
        <div class="flex gap-2 mb-4">
            <input type="text" id="songInput" class="w-full bg-gray-700 text-white rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-cyan-500" placeholder="Masukkan judul lagu...">
            <button id="addBtn" class="bg-cyan-500 hover:bg-cyan-600 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-300">
                <i class="fas fa-plus"></i>
            </button>
        </div>

        <!-- Kontrol Player -->
        <div class="bg-gray-700 rounded-lg p-4 mb-4">
            <div class="text-center mb-3">
                <p class="text-sm text-gray-400">SEDANG DIPUTAR</p>
                <h2 id="nowPlaying" class="text-xl font-semibold truncate h-7">Pilih lagu untuk diputar</h2>
            </div>
            <div class="flex justify-center items-center gap-6">
                <button id="prevBtn" class="text-gray-400 hover:text-white text-2xl transition-colors"><i class="fas fa-backward-step"></i></button>
                <button id="playBtn" class="bg-cyan-500 hover:bg-cyan-600 text-white rounded-full w-16 h-16 flex items-center justify-center text-3xl transition-transform transform hover:scale-110">
                    <i id="playIcon" class="fas fa-play"></i>
                </button>
                <button id="nextBtn" class="text-gray-400 hover:text-white text-2xl transition-colors"><i class="fas fa-forward-step"></i></button>
            </div>
        </div>

        <!-- Daftar Playlist -->
        <h3 class="text-lg font-semibold mb-2 text-gray-300">Daftar Putar</h3>
        <div id="playlistContainer" class="bg-gray-700 rounded-lg max-h-60 overflow-y-auto">
            <p id="emptyMessage" class="text-gray-500 text-center p-8">Playlist masih kosong.</p>
        </div>

        <!-- Fitur Import -->
        <div class="mt-4 text-center">
            <label for="importFile" class="cursor-pointer bg-gray-600 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-300 inline-block">
                <i class="fas fa-upload mr-2"></i> Import dari File (.txt)
            </label>
            <input type="file" id="importFile" class="hidden" accept=".txt">
             <p id="importStatus" class="text-sm text-gray-500 mt-2"></p>
        </div>

    </div>

    <script>
        // --- Implementasi Doubly Linked List ---
        class Node {
            constructor(data) {
                this.data = data; // data = judul lagu
                this.next = null; // pointer ke lagu berikutnya
                this.prev = null; // pointer ke lagu sebelumnya
            }
        }

        class DoublyLinkedList {
            constructor() {
                this.head = null;
                this.tail = null;
                this.length = 0;
                this.currentNode = null; // Node yang sedang diputar
                this.isPlaying = false;
            }

            // Menambah lagu di akhir playlist
            add(data) {
                const newNode = new Node(data);
                if (this.length === 0) {
                    this.head = newNode;
                    this.tail = newNode;
                } else {
                    this.tail.next = newNode;
                    newNode.prev = this.tail;
                    this.tail = newNode;
                }
                this.length++;
            }

            // Menghapus lagu berdasarkan data (judul)
            remove(data) {
                if (!this.head) return;

                let currentNode = this.head;
                while(currentNode) {
                    if (currentNode.data === data) {
                        // Jika yang dihapus adalah node yang sedang diputar
                        if (this.currentNode === currentNode) {
                             // Jika ada lagu selanjutnya, putar itu. Jika tidak, putar lagu sebelumnya.
                            if(currentNode.next) this.currentNode = currentNode.next;
                            else if (currentNode.prev) this.currentNode = currentNode.prev;
                            else this.currentNode = null; // Playlist jadi kosong
                        }
                        
                        if (currentNode.prev) {
                            currentNode.prev.next = currentNode.next;
                        } else {
                            this.head = currentNode.next;
                        }

                        if (currentNode.next) {
                            currentNode.next.prev = currentNode.prev;
                        } else {
                            this.tail = currentNode.prev;
                        }
                        
                        this.length--;
                        return true; // Berhasil dihapus
                    }
                    currentNode = currentNode.next;
                }
                return false; // Lagu tidak ditemukan
            }

            // Memulai atau menjeda pemutaran
            togglePlay() {
                if (this.length === 0) return;
                
                if (!this.currentNode) {
                    this.currentNode = this.head; // Mulai dari awal jika belum ada yg diputar
                }
                
                this.isPlaying = !this.isPlaying;
            }
            
            // Pindah ke lagu berikutnya
            next() {
                if (!this.currentNode || !this.currentNode.next) return;
                this.currentNode = this.currentNode.next;
                this.isPlaying = true; // Langsung putar lagu berikutnya
            }
            
            // Pindah ke lagu sebelumnya
            prev() {
                if (!this.currentNode || !this.currentNode.prev) return;
                this.currentNode = this.currentNode.prev;
                this.isPlaying = true; // Langsung putar lagu sebelumnya
            }
        }
        
        // --- Logika Aplikasi ---
        document.addEventListener('DOMContentLoaded', () => {
            const playlist = new DoublyLinkedList();

            // Referensi Elemen DOM
            const songInput = document.getElementById('songInput');
            const addBtn = document.getElementById('addBtn');
            const playlistContainer = document.getElementById('playlistContainer');
            const emptyMessage = document.getElementById('emptyMessage');
            const nowPlaying = document.getElementById('nowPlaying');
            const playBtn = document.getElementById('playBtn');
            const playIcon = document.getElementById('playIcon');
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const importFile = document.getElementById('importFile');
            const importStatus = document.getElementById('importStatus');

            // Fungsi untuk me-render ulang tampilan playlist
            function renderPlaylist() {
                playlistContainer.innerHTML = '';
                if (playlist.length === 0) {
                    playlistContainer.appendChild(emptyMessage);
                    emptyMessage.style.display = 'block';
                    nowPlaying.textContent = 'Playlist kosong';
                    return;
                }
                
                emptyMessage.style.display = 'none';
                let currentNode = playlist.head;
                let index = 0;
                while(currentNode) {
                    const item = document.createElement('div');
                    item.className = 'playlist-item flex items-center justify-between p-3 border-b border-gray-600 hover:bg-gray-600 transition-colors cursor-pointer';
                    item.dataset.songData = currentNode.data;

                    const titleDiv = document.createElement('div');
                    titleDiv.className = 'flex items-center gap-4';
                    
                    const songNumber = document.createElement('span');
                    songNumber.className = 'text-gray-400 w-5';
                    songNumber.textContent = `${index + 1}.`;

                    const songTitle = document.createElement('span');
                    songTitle.className = 'text-white';
                    songTitle.textContent = currentNode.data;

                    titleDiv.appendChild(songNumber);
                    titleDiv.appendChild(songTitle);

                    const deleteButton = document.createElement('button');
                    deleteButton.className = 'delete-btn text-red-500 hover:text-red-400 text-lg';
                    deleteButton.innerHTML = '<i class="fas fa-trash-alt"></i>';
                    deleteButton.dataset.songData = currentNode.data;
                    
                    item.appendChild(titleDiv);
                    item.appendChild(deleteButton);
                    playlistContainer.appendChild(item);
                    
                    currentNode = currentNode.next;
                    index++;
                }
                updatePlayerUI();
            }
            
            // Fungsi untuk update UI Player
            function updatePlayerUI() {
                if (playlist.currentNode) {
                    nowPlaying.textContent = playlist.currentNode.data;
                } else if(playlist.length > 0) {
                    nowPlaying.textContent = 'Tekan play untuk memulai';
                } else {
                    nowPlaying.textContent = 'Playlist kosong';
                }
                
                if (playlist.isPlaying) {
                    playIcon.classList.remove('fa-play');
                    playIcon.classList.add('fa-pause');
                } else {
                    playIcon.classList.remove('fa-pause');
                    playIcon.classList.add('fa-play');
                }
            }

            // Event Listener untuk menambah lagu
            function handleAddSong() {
                 const songTitle = songInput.value.trim();
                if (songTitle) {
                    playlist.add(songTitle);
                    songInput.value = '';
                    renderPlaylist();
                }
            }
            
            addBtn.addEventListener('click', handleAddSong);
            songInput.addEventListener('keypress', (e) => {
                if(e.key === 'Enter') {
                    handleAddSong();
                }
            });

            // Event Listener untuk hapus dan putar lagu dari list
            playlistContainer.addEventListener('click', (e) => {
                const target = e.target;
                
                // Logika Hapus Lagu
                const deleteButton = target.closest('.delete-btn');
                if(deleteButton) {
                    const songData = deleteButton.dataset.songData;
                    if(playlist.remove(songData)) {
                        renderPlaylist(); // Render ulang setelah menghapus
                        updatePlayerUI();
                    }
                    return; // Hentikan eksekusi lebih lanjut
                }
                
                // Logika Memutar Lagu Saat di-klik
                const playlistItem = target.closest('.playlist-item');
                if(playlistItem) {
                    const songData = playlistItem.dataset.songData;
                    let nodeToPlay = playlist.head;
                    while(nodeToPlay) {
                        if (nodeToPlay.data === songData) {
                            playlist.currentNode = nodeToPlay;
                            playlist.isPlaying = true;
                            updatePlayerUI();
                            break;
                        }
                        nodeToPlay = nodeToPlay.next;
                    }
                }
            });

            // Event Listener untuk kontrol player
            playBtn.addEventListener('click', () => {
                playlist.togglePlay();
                updatePlayerUI();
            });

            nextBtn.addEventListener('click', () => {
                playlist.next();
                updatePlayerUI();
            });

            prevBtn.addEventListener('click', () => {
                playlist.prev();
                updatePlayerUI();
            });
            
            // Event Listener untuk Import File
            importFile.addEventListener('change', (event) => {
                const file = event.target.files[0];
                if (!file) {
                    return;
                }

                const reader = new FileReader();
                reader.onload = (e) => {
                    const content = e.target.result;
                    const songs = content.split('\n').filter(song => song.trim() !== '');
                    
                    if (songs.length > 0) {
                        songs.forEach(song => playlist.add(song.trim()));
                        renderPlaylist();
                        importStatus.textContent = `${songs.length} lagu berhasil diimpor!`;
                    } else {
                        importStatus.textContent = `File kosong atau format tidak sesuai.`;
                    }
                     // Reset input file agar bisa import file yang sama lagi
                    importFile.value = '';
                };
                reader.onerror = () => {
                    importStatus.textContent = `Gagal membaca file.`;
                    importFile.value = '';
                }
                reader.readAsText(file);
            });


            // Render pertama kali
            renderPlaylist();
        });
    </script>
</body>
</html>
